[2022-05-17 20:08:47,574] {taskinstance.py:1043} INFO - Dependencies all met for <TaskInstance: big_finance_dag.fetch_quotation_from_TSLA manual__2022-05-17T18:08:38.999461+00:00 [queued]>
[2022-05-17 20:08:47,579] {taskinstance.py:1043} INFO - Dependencies all met for <TaskInstance: big_finance_dag.fetch_quotation_from_TSLA manual__2022-05-17T18:08:38.999461+00:00 [queued]>
[2022-05-17 20:08:47,579] {taskinstance.py:1249} INFO - 
--------------------------------------------------------------------------------
[2022-05-17 20:08:47,579] {taskinstance.py:1250} INFO - Starting attempt 1 of 2
[2022-05-17 20:08:47,579] {taskinstance.py:1251} INFO - 
--------------------------------------------------------------------------------
[2022-05-17 20:08:47,595] {taskinstance.py:1270} INFO - Executing <Task(PythonOperator): fetch_quotation_from_TSLA> on 2022-05-17 18:08:38.999461+00:00
[2022-05-17 20:08:47,596] {standard_task_runner.py:52} INFO - Started process 6954 to run task
[2022-05-17 20:08:47,598] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'big_finance_dag', 'fetch_quotation_from_TSLA', 'manual__2022-05-17T18:08:38.999461+00:00', '--job-id', '28', '--raw', '--subdir', 'DAGS_FOLDER/big_finance_dag.py', '--cfg-path', '/tmp/tmps685yxg5', '--error-file', '/tmp/tmp06g_042t']
[2022-05-17 20:08:47,599] {standard_task_runner.py:80} INFO - Job 28: Subtask fetch_quotation_from_TSLA
[2022-05-17 20:08:47,640] {logging_mixin.py:109} INFO - Running <TaskInstance: big_finance_dag.fetch_quotation_from_TSLA manual__2022-05-17T18:08:38.999461+00:00 [running]> on host DESKTOP-O4M0F04.localdomain
[2022-05-17 20:08:47,675] {taskinstance.py:1446} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=airflow@example.com
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=big_finance_dag
AIRFLOW_CTX_TASK_ID=fetch_quotation_from_TSLA
AIRFLOW_CTX_EXECUTION_DATE=2022-05-17T18:08:38.999461+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-05-17T18:08:38.999461+00:00
[2022-05-17 20:08:47,686] {logging_mixin.py:109} INFO - Successful connection to mongo db
[2022-05-17 20:08:48,001] {taskinstance.py:1774} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/airflow/operators/python.py", line 188, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/udimini/airflow/dags/big_finance_dag.py", line 31, in push_quotation_on_datalake
    result = db.reviews.insert_one(quotation)
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/collection.py", line 606, in insert_one
    self._insert_one(
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/collection.py", line 547, in _insert_one
    self.__database.client._retryable_write(acknowledged, _insert_command, session)
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1399, in _retryable_write
    return self._retry_with_session(retryable, func, s, None)
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1286, in _retry_with_session
    return self._retry_internal(retryable, func, session, bulk)
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1307, in _retry_internal
    server = self._select_server(writable_server_selector, session)
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1186, in _select_server
    topology = self._get_topology()
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1143, in _get_topology
    self._topology.open()
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/topology.py", line 188, in open
    self._ensure_opened()
  File "/home/udimini/airflow_venv/airflow_venv/lib/python3.8/site-packages/pymongo/topology.py", line 573, in _ensure_opened
    raise InvalidOperation("Cannot use MongoClient after close")
pymongo.errors.InvalidOperation: Cannot use MongoClient after close
[2022-05-17 20:08:48,005] {taskinstance.py:1278} INFO - Marking task as UP_FOR_RETRY. dag_id=big_finance_dag, task_id=fetch_quotation_from_TSLA, execution_date=20220517T180838, start_date=20220517T180847, end_date=20220517T180848
[2022-05-17 20:08:48,018] {standard_task_runner.py:93} ERROR - Failed to execute job 28 for task fetch_quotation_from_TSLA (Cannot use MongoClient after close; 6954)
[2022-05-17 20:08:48,052] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-05-17 20:08:48,064] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
